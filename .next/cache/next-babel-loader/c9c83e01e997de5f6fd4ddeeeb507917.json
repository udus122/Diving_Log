{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport firebase from '../../lib/firebaseInit';\nimport { storage } from \"../../firebase\";\n\nvar Add_Form = /*#__PURE__*/function (_Component) {\n  _inherits(Add_Form, _Component);\n\n  var _super = _createSuper(Add_Form);\n\n  function Add_Form(props) {\n    var _this;\n\n    _classCallCheck(this, Add_Form);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      Prefectures: '',\n      Place_Name: '',\n      DAY: '',\n      Shop_Name: '',\n      Weather: '',\n      SuitType: '',\n      Marine_life: '',\n      Memo: '',\n      image: null,\n      url: '',\n      progress: 0,\n      checkFileUploadFlg: false,\n      errorMsg: ''\n    };\n    _this.onChangePrefectures = _this.onChangePrefectures.bind(_assertThisInitialized(_this));\n    _this.onChangePlace_Name = _this.onChangePlace_Name.bind(_assertThisInitialized(_this));\n    _this.onChangeDAY = _this.onChangeDAY.bind(_assertThisInitialized(_this));\n    _this.onChangeShop_Name = _this.onChangeShop_Name.bind(_assertThisInitialized(_this));\n    _this.onChangeWeather = _this.onChangeWeather.bind(_assertThisInitialized(_this));\n    _this.onChangeSuitType = _this.onChangeSuitType.bind(_assertThisInitialized(_this));\n    _this.onChangeMarine_life = _this.onChangeMarine_life.bind(_assertThisInitialized(_this));\n    _this.onChangeMemo = _this.onChangeMemo.bind(_assertThisInitialized(_this));\n    _this.exeAdd = _this.exeAdd.bind(_assertThisInitialized(_this));\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.handleUpload = _this.handleUpload.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Add_Form, [{\n    key: \"handleChange\",\n    value: function handleChange(e) {\n      if (e.target.files[0]) {\n        this.setState({\n          image: e.target.files[0]\n        });\n        this.setState({\n          checkFileUploadFlg: true\n        });\n      }\n    }\n  }, {\n    key: \"handleUpload\",\n    value: function handleUpload() {\n      var _this2 = this;\n\n      var uploadTask = storage.ref(\"images/\".concat(this.state.image.name)).put(this.state.image);\n      uploadTask.on(\"state_changed\", function (snapshot) {\n        var progressnew = Math.round(snapshot.bytesTransferred / snapshot.totalBytes * 100);\n\n        _this2.setState({\n          progress: progressnew\n        });\n\n        _this2.setState({\n          url: _this2.state.url\n        });\n      }, function (error) {\n        console.log(error);\n      }, function () {\n        storage.ref(\"images\").child(_this2.state.image.name).getDownloadURL().then(function (url) {\n          console.log(url);\n\n          _this2.setState({\n            url: url\n          });\n        });\n      });\n      console.log(\"image: \", this.state.image);\n      event.preventDefault();\n    }\n  }, {\n    key: \"onChangePrefectures\",\n    value: function onChangePrefectures(e) {\n      this.setState({\n        Prefectures: e.target.value\n      });\n    }\n  }, {\n    key: \"onChangePlace_Name\",\n    value: function onChangePlace_Name(e) {\n      this.setState({\n        Place_Name: e.target.value\n      });\n    }\n  }, {\n    key: \"onChangeDAY\",\n    value: function onChangeDAY(e) {\n      this.setState({\n        DAY: e.target.value\n      });\n    }\n  }, {\n    key: \"onChangeShop_Name\",\n    value: function onChangeShop_Name(e) {\n      this.setState({\n        Shop_Name: e.target.value\n      });\n    }\n  }, {\n    key: \"onChangeWeather\",\n    value: function onChangeWeather(e) {\n      this.setState({\n        Weather: e.target.value\n      });\n    }\n  }, {\n    key: \"onChangeSuitType\",\n    value: function onChangeSuitType(e) {\n      this.setState({\n        SuitType: e.target.value\n      });\n    }\n  }, {\n    key: \"onChangeMarine_life\",\n    value: function onChangeMarine_life(e) {\n      this.setState({\n        Marine_life: e.target.value\n      });\n    }\n  }, {\n    key: \"onChangeMemo\",\n    value: function onChangeMemo(e) {\n      this.setState({\n        Memo: e.target.value\n      });\n    } //データ登録\n\n  }, {\n    key: \"exeAdd\",\n    value: function exeAdd(e) {\n      var answer = window.confirm(\"登録内容にお間違いはありませんか？？\");\n\n      if (answer) {\n        var data = {\n          Prefectures: this.state.Prefectures,\n          Place_Name: this.state.Place_Name,\n          DAY: this.state.DAY,\n          Shop_Name: this.state.Shop_Name,\n          Weather: this.state.Weather,\n          SuitType: this.state.SuitType,\n          Marine_life: this.state.Marine_life,\n          Memo: this.state.Memo\n        };\n\n        if (this.isNullForm()) {\n          var db = firebase.database();\n          var ref = db.ref('diving-point-map');\n          console.log(ref);\n          ref.set(data);\n          this.setState({\n            Prefectures: '',\n            Place_Name: '',\n            DAY: '',\n            Shop_Name: '',\n            Weather: '',\n            SuitType: '',\n            Marine_life: '',\n            Memo: '※データを登録しました。ご協力ありがとうございます！！'\n          });\n          event.preventDefault();\n        } else {\n          window.alert(this.state.errorMsg);\n          event.preventDefault();\n        }\n      }\n\n      event.preventDefault();\n    }\n  }, {\n    key: \"isNullForm\",\n    value: function isNullForm() {\n      if (this.state.Prefectures == '') {\n        this.setState({\n          errorMsg: 'Prefecturesを入力してください'\n        });\n        return false;\n      }\n\n      if (this.state.Place_Name == '') {\n        this.setState({\n          errorMsg: 'Place_Nameを入力してください'\n        });\n        return false;\n      }\n\n      if (this.state.DAY == '') {\n        this.setState({\n          errorMsg: 'DAYを入力してください'\n        });\n        return false;\n      }\n\n      if (this.state.Shop_Name == '') {\n        this.setState({\n          errorMsg: 'Shop_Nameを入力してください'\n        });\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return __jsx(\"div\", null, __jsx(\"form\", null, __jsx(\"table\", null, __jsx(\"tbody\", null, __jsx(\"tr\", null, __jsx(\"th\", null, \"Prefectures:\"), __jsx(\"td\", null, __jsx(\"input\", {\n        type: \"text\",\n        size: \"50\",\n        maxLength: \"7\",\n        required: true,\n        value: this.state.Prefectures,\n        onChange: this.onChangePrefectures,\n        placeholder: \"\\u90FD\\u9053\\u5E9C\\u770C\"\n      }))), __jsx(\"tr\", null, __jsx(\"th\", null, \"Place_Name:\"), __jsx(\"td\", null, __jsx(\"input\", {\n        type: \"text\",\n        size: \"50\",\n        maxLength: \"15\",\n        required: true,\n        value: this.state.Place_Name,\n        onChange: this.onChangePlace_Name,\n        placeholder: \"\\u30DD\\u30A4\\u30F3\\u30C8\\u540D\\uFF08\\u5730\\u540D\\uFF09\"\n      }))), __jsx(\"tr\", null, __jsx(\"th\", null, \"DAY:\"), __jsx(\"td\", null, __jsx(\"input\", {\n        type: \"date\",\n        size: \"50\",\n        maxLength: \"10\",\n        required: true,\n        value: this.state.DAY,\n        onChange: this.onChangeDAY,\n        placeholder: \"YYYY/MM/DD\"\n      }))), __jsx(\"tr\", null, __jsx(\"th\", null, \"Weather:\"), __jsx(\"td\", null, __jsx(\"input\", {\n        type: \"text\",\n        size: \"50\",\n        maxLength: \"10\",\n        value: this.state.Weather,\n        onChange: this.onChangeWeather,\n        placeholder: \"\\u5FEB\\u6674\"\n      }))), __jsx(\"tr\", null, __jsx(\"th\", null, \"Shop_Name:\"), __jsx(\"td\", null, __jsx(\"input\", {\n        type: \"text\",\n        size: \"50\",\n        maxLength: \"20\",\n        required: true,\n        value: this.state.Shop_Name,\n        onChange: this.onChangeShop_Name,\n        placeholder: \"\\u25CB\\u25CB\\u30C0\\u30A4\\u30D3\\u30F3\\u30B0\\u30B7\\u30E7\\u30C3\\u30D7\"\n      }))), __jsx(\"tr\", null, __jsx(\"th\", null, \"SuitType:\"), __jsx(\"td\", null, __jsx(\"input\", {\n        type: \"text\",\n        size: \"50\",\n        maxLength: \"10\",\n        value: this.state.SuitType,\n        onChange: this.onChangeSuitType,\n        placeholder: \"\\u30C9\\u30E9\\u30A4\\u30B9\\u30FC\\u30C4/\\u30A6\\u30A7\\u30C3\\u30C8\\u30B9\\u30FC\\u30C4\"\n      }))), __jsx(\"tr\", null, __jsx(\"th\", null, \"Marine life:\"), __jsx(\"td\", null, __jsx(\"input\", {\n        type: \"text\",\n        size: \"50\",\n        maxLength: \"20\",\n        value: this.state.Marine_life,\n        onChange: this.onChangeMarine_life,\n        placeholder: \"\\u305D\\u306E\\u65E5\\u4E00\\u756A\\u306E\\u751F\\u304D\\u7269\\u306F\\u306A\\u3093\\u3067\\u3057\\u3087\\u3046\\u304B????\",\n        required: true\n      }))), __jsx(\"tr\", null, __jsx(\"th\", null, \"Memo:\"), __jsx(\"td\", null, __jsx(\"input\", {\n        type: \"textarea\",\n        size: \"50\",\n        maxLength: \"20\",\n        value: this.state.Memo,\n        onChange: this.onChangeMemo,\n        placeholder: \"\\u900F\\u660E\\u5EA6\\u30FB\\u900F\\u8996\\u5EA6\\u7B49\\u3001\\u3054\\u81EA\\u7531\\u306B\\u304A\\u4F7F\\u3044\\u304F\\u3060\\u3055\\u3044\"\n      }))))), __jsx(\"br\", null), __jsx(\"p\", null, \"\\u3042\\u306A\\u305F\\u306E\\u30D9\\u30B9\\u30C8\\u30B7\\u30E7\\u30C3\\u30C8\\u3092\\u5171\\u6709\\u3057\\u307E\\u305B\\u3093\\u304B????\"), __jsx(\"div\", {\n        className: \"FileImage\"\n      }, __jsx(\"progress\", {\n        value: this.state.progress,\n        max: \"100\"\n      }), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"input\", {\n        type: \"file\",\n        onChange: this.handleChange\n      }), this.state.checkFileUploadFlg ? __jsx(\"button\", {\n        onClick: this.handleUpload\n      }, \"Upload\") : __jsx(\"p\", null, \"\\u30D5\\u30A1\\u30A4\\u30EB\\u3092\\u9078\\u629E\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"), __jsx(\"br\", null), this.state.url, __jsx(\"br\", null), __jsx(\"div\", {\n        className: \"p-grid_list-images\"\n      }, __jsx(\"img\", {\n        src: this.state.url || \"http://via.placeholder.com/300\",\n        alt: \"firebase-image\",\n        className: \"img\"\n      }))), __jsx(\"button\", {\n        onClick: this.exeAdd\n      }, \"Add\")));\n    }\n  }]);\n\n  return Add_Form;\n}(Component);\n\n;\nexport default Add_Form;","map":null,"metadata":{},"sourceType":"module"}